<article
    class="post-2196 post type-post status-publish format-standard has-post-thumbnail hentry category-technical category-user-experience category-user-centered-services tag-css tag-pattern-library tag-testing tag-ux-design">
    <header>
        <h1 class="entry-title">CSS testing and pattern libraries</h1>
        <h2>Visual regression testing with PhantomCSS</h2>
        <p class="byline author vcard"><img alt=""
                src="https://secure.gravatar.com/avatar/4eda2c677ab3ca24daa2368a4acf1a03?s=40&amp;d=mm&amp;r=g"
                srcset="https://secure.gravatar.com/avatar/4eda2c677ab3ca24daa2368a4acf1a03?s=80&amp;d=mm&amp;r=g 2x"
                class="avatar avatar-40 photo" height="40" width="40" loading="lazy">By <a
                href="https://blogs.kent.ac.uk/webdev/author/mb324/" rel="author" class="fn">Matthew Bull</a> | <time
                class="updated" datetime="2015-10-16T16:49:40+01:00">16&nbsp;October&nbsp;2015</time></p>
    </header>
    <div class="entry-featured">
        <img src="https://blogs.kent.ac.uk/webdev/files/2015/10/2949078773_7e106dd5d9_o-1024x683.jpg"
            class="featured-img" alt="">
    </div>
    <div class="entry-content">
        <p>The <a href="http://www.kent.ac.uk/is/projects/sds-replacement/">project I’m working on right
                now</a>&nbsp;uses a bought-in piece of software with a complex set of patterns and styles. HTML elements
            can be used in different ways in different contexts, and the resulting css can be complicated and fiddly.
        </p>
        <p>To add to the complexity, much of the system has already been built (and is live) while the majority has yet
            to be built and is&nbsp;actively evolving.</p>
        <p>If ever there were&nbsp;a use-case for automated testing, this would be it.</p>
        <p>And yet as we all know testing web styling has in the past usually involved making changes, checking a few
            key pages, and then hoping everything will be ok. This works ok in smaller projects, but can be time
            consuming and error prone in larger projects.</p>
        <h2>PhantomCSS</h2>
        <p>I therefore looked at a handy visual regression tool called <a
                href="https://github.com/Huddle/PhantomCSS">PhantomCSS</a>. It’s actually a <a
                href="https://github.com/n1k0/casperjs">CasperJS</a> module which uses <a
                href="https://github.com/ariya/phantomjs/">PhantomJS</a> and <a
                href="http://huddle.github.io/Resemble.js/">Resemble.js</a>&nbsp;to compare baseline screenshots of a
            webpage with the current screenshots.</p>
        <p>Of course, comparing one complete web page with another complete web page isn’t much use, especially if those
            pages are dynamic.</p>
        <p>Far better is to compare your website’s building blocks in a pattern library.</p>
        <p>Luckily I already have a living pattern library for this project, which you can find out more about on my <a
                href="https://blogs.kent.ac.uk/webdev/2015/09/24/building-and-hosting-a-pattern-library-on-github/">blog
                post about a github-hosted pattern library</a>. You might also want to bear Brad Frost’s <a
                href="http://bradfrost.com/blog/post/atomic-web-design/">atomic design principles</a> in mind too.</p>
        <p>With a pattern library you can tell PhantomCSS to pick out the HTML examples (for example using an
            <code>id</code> on each example). It will then build screenshots of things like example panels, tables,
            forms and compare them to your baseline. Any differences will be picked up before you roll to live.</p>
        <h2>Setup</h2>
        <p>The great thing about PhantomCSS is that it’s pretty easy to set up. I’m not per se a full-on web developer
            (although I have some experience in that area) but I managed to get things set up pretty quickly.</p>
        <p>If you’re at all familiar with <a href="https://nodejs.org/en/">node</a> and <a
                href="http://browsenpm.org">npm</a>&nbsp;then you can set up the required phantomcss, phantomjs,
            casperjs, and&nbsp;resemblejs dependencies in your <code>package.json</code> file.</p>
        <p>You will also need the <code>phantomcss.js</code> config file. I had to manually copy this into my project,
            as I couldn’t figure out how else to include it. There might be a better way of doing this, but for now it
            works.</p>
        <h2>Get testing</h2>
        <p>Finally you’ll need to write your test suite file, using standard casperjs syntax.</p>
        <p>For example you’ll end up writing tests like:</p>
        <pre><code>
casper.thenClick('a[href="patterns.html"]');
casper.then( function () {
  phantomcss.screenshot( '#example-table', 'tables' );
  phantomcss.screenshot( '#example-form', 'forms' );
});
</code>
</pre>
        <p>where casperjs follows a link, loads a page, looks for certain elements, and takes a screenshot.</p>
        <h2>Any good?</h2>
        <p>I’ve so far used PhantomCSS&nbsp;in a fairly experimental way. I certainly found it&nbsp;to be much much
            nicer than having to check things manually!</p>
        <p>Setup and configuration was pretty simple even though I’m very far from being a hardcore dev.</p>
        <p>I would say that for this to work you really need a pattern library using the principles of atomic design.
            That will give you a great base for testing out all the possible design examples.</p>
        <p>In my current&nbsp;project things were a bit more complex design-wise. It’s a pain but it’s just how things
            often are. So it made testing far harder, but still possible in many cases.</p>
        <p>For that reason I’d only advise automated css testing as a kind of fire blanket. It gives you peace of mind,
            but you will always need to do some manual testing as well.</p>
        <h2>Summary</h2>
        <p>PhantomCSS is a great tool for quickly and easily setting up some visual regression testing, preferably on
            your site’s pattern library (you <em>do</em> have a pattern library, don’t you?)</p>
        <p>It won’t cure all your most complex css testing issues, but it will give you an element of peace of mind that
            if you edit some css it won’t have some catastrophically weird effect somewhere else.</p>
    </div>
    <footer>
        <span class="cat-links"><span class="screen-reader-text">Categories:&nbsp;</span><a
                href="https://blogs.kent.ac.uk/webdev/category/technical/" rel="category tag">Technical</a> <a
                href="https://blogs.kent.ac.uk/webdev/category/user-experience/" rel="category tag">User experience</a>
            <a href="https://blogs.kent.ac.uk/webdev/category/user-centered-services/" rel="category tag">user-centered
                services</a></span>
        <span class="tag-links"><span class="screen-reader-text">Tags:&nbsp;</span><a
                href="https://blogs.kent.ac.uk/webdev/tag/css/" rel="tag">css</a> <a
                href="https://blogs.kent.ac.uk/webdev/tag/pattern-library/" rel="tag">pattern library</a> <a
                href="https://blogs.kent.ac.uk/webdev/tag/testing/" rel="tag">testing</a> <a
                href="https://blogs.kent.ac.uk/webdev/tag/ux-design/" rel="tag">ux design</a></span>
    </footer>

    <section id="comments" class="comments">


        <div id="respond" class="comment-respond">
            <h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow"
                        id="cancel-comment-reply-link"
                        href="/webdev/2015/10/16/css-testing-and-pattern-libraries/#respond"
                        style="display:none;">Cancel reply</a></small></h3>
            <form action="https://blogs.kent.ac.uk/webdev/wp-comments-post.php" method="post" id="commentform"
                class="comment-form" novalidate="">
                <p class="logged-in-as"><a href="https://blogs.kent.ac.uk/webdev/wp-admin/profile.php"
                        aria-label="Logged in as Matthew Bull. Edit your profile.">Logged in as Matthew Bull</a>. <a
                        href="https://blogs.kent.ac.uk/webdev/wp-login.php?action=logout&amp;redirect_to=https%3A%2F%2Fblogs.kent.ac.uk%2Fwebdev%2F2015%2F10%2F16%2Fcss-testing-and-pattern-libraries%2F&amp;_wpnonce=c0cb87439e">Log
                        out?</a> <span class="required-field-message" aria-hidden="true">Required fields are marked
                        <span class="required" aria-hidden="true">*</span></span></p>
                <p class="comment-form-comment"><label for="comment">Comment <span class="required"
                            aria-hidden="true">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8"
                        maxlength="65525" required=""></textarea></p>
                <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit"
                        value="Post Comment"> <input type="hidden" name="comment_post_ID" value="2196"
                        id="comment_post_ID">
                    <input type="hidden" name="comment_parent" id="comment_parent" value="0">
                </p>
                <p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce"
                        value="0d2c28f782"></p><input type="hidden" id="_wp_unfiltered_html_comment_disabled"
                    name="_wp_unfiltered_html_comment" value="99253402f9">
                <script>(function () { if (window === window.parent) { document.getElementById('_wp_unfiltered_html_comment_disabled').name = '_wp_unfiltered_html_comment'; } })();</script>
                <p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_">
                    <label>Δ<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input
                        type="hidden" id="ak_js_1" name="ak_js" value="1749299806278">
                    <script>document.getElementById("ak_js_1").setAttribute("value", (new Date()).getTime());</script>
                </p>
            </form>
        </div><!-- #respond -->
    </section>
</article>